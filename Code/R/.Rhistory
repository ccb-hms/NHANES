dept_bioinformaticsskills_grad <- unique(paste0(dept_bioinformaticsskills_grad_df$"Var1"," (n=", dept_bioinformaticsskills_grad_df$"Freq", ")"))
dept_bioinformaticsskills_grad[13] <- paste0("All Programs (n=", (sum(dept_bioinformaticsskills_grad_df$"Freq")), ")")
gathercols <- c("Biological network and systems analyses","Structure analysis and prediction","Single-cell RNA-seq analysis","Bulk RNA-seq analysis","Other \'omic\' analyses","Other sequencing technologies","Gene annotation and function prediction","Molecular interactions","Using online tools and databases","Genome-wide association studies (GWAS)","Phylogenetics","Enrichment Analyses")
bioinformaticsskills_grad <- gather(bioinformaticsskills_grad, "Competency", "Current Skill Level", all_of(gathercols))
bioinformaticsskills_grad <- data.frame(table(bioinformaticsskills_grad$Program, bioinformaticsskills_grad$Competency, bioinformaticsskills_grad$"Current Skill Level"))
bioinformaticsskills_grad <- bioinformaticsskills_grad %>% dplyr::rename("Program" = "Var1")
bioinformaticsskills_grad <- bioinformaticsskills_grad %>% dplyr::rename("Competency" = "Var2")
bioinformaticsskills_grad <- bioinformaticsskills_grad %>% dplyr::rename("CurrentSkillLevel" = "Var3")
statisticsresearch_grad <- grad_df[, c("Please select your program of study.","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Core statistical concepts)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Hypothesis testing)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Linear regression and generalized linear models)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: classification)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: clustering)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Exploratory data analysis)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Smoothing, lasso, ridge regression, and regularization)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Mathematical modeling and simulations)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Running computational experiments)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Parameter estimation)")]
statisticsresearch_grad <- as.data.frame(statisticsresearch_grad)
n_statisticsresearch_grad <- nrow(statisticsresearch_grad)
statisticsresearch_grad <- statisticsresearch_grad %>% dplyr::rename("Department" = "Please select your program of study.")
statisticsresearch_grad[is.na(statisticsresearch_grad)] <- "Unchecked"
statisticsresearch_grad <- statisticsresearch_grad[!statisticsresearch_grad$"Department" == "Unchecked", ]
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Hypothesis testing)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Hypothesis testing)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Linear regression and generalized linear models)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Linear regression and generalized linear models)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: classification)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: classification)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: clustering)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: clustering)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Exploratory data analysis)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Exploratory data analysis)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Smoothing, lasso, ridge regression, and regularization)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Smoothing, lasso, ridge regression, and regularization)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Mathematical modeling and simulations)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Mathematical modeling and simulations)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Running computational experiments)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Running computational experiments)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Parameter estimation)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Parameter estimation)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Core statistical concepts)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Core statistical concepts)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad_raw <- statisticsresearch_grad
statisticsresearch_grad_raw <- statisticsresearch_grad
dept_statisticsresearch_grad_df <- as.data.frame(table(statisticsresearch_grad$Department))
dept_statisticsresearch_grad <- unique(paste0(dept_statisticsresearch_grad_df$"Var1"," (n=", dept_statisticsresearch_grad_df$"Freq", ")"))
dept_statisticsresearch_grad[13] <- paste0("All Departments (n=", (sum(dept_statisticsresearch_grad_df$"Freq")), ")")
gathercols <- c("Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Core statistical concepts)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Hypothesis testing)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Linear regression and generalized linear models)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: classification)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: clustering)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Exploratory data analysis)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Smoothing, lasso, ridge regression, and regularization)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Mathematical modeling and simulations)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Running computational experiments)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Parameter estimation")
statisticsresearch_grad <- gather(statisticsresearch_grad, "Competency", "Importance", all_of(gathercols))
statisticsresearch_grad <- grad_df[, c("Please select your program of study.","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Core statistical concepts)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Hypothesis testing)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Linear regression and generalized linear models)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: classification)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: clustering)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Exploratory data analysis)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Smoothing, lasso, ridge regression, and regularization)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Mathematical modeling and simulations)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Running computational experiments)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Parameter estimation)")]
statisticsresearch_grad <- as.data.frame(statisticsresearch_grad)
n_statisticsresearch_grad <- nrow(statisticsresearch_grad)
statisticsresearch_grad <- statisticsresearch_grad %>% dplyr::rename("Department" = "Please select your program of study.")
statisticsresearch_grad[is.na(statisticsresearch_grad)] <- "Unchecked"
statisticsresearch_grad <- statisticsresearch_grad[!statisticsresearch_grad$"Department" == "Unchecked", ]
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Hypothesis testing)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Hypothesis testing)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Linear regression and generalized linear models)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Linear regression and generalized linear models)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: classification)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: classification)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: clustering)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: clustering)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Exploratory data analysis)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Exploratory data analysis)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Smoothing, lasso, ridge regression, and regularization)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Smoothing, lasso, ridge regression, and regularization)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Mathematical modeling and simulations)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Mathematical modeling and simulations)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Running computational experiments)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Running computational experiments)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Parameter estimation)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Parameter estimation)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Core statistical concepts)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Core statistical concepts)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad_raw <- statisticsresearch_grad
dept_statisticsresearch_grad_df <- as.data.frame(table(statisticsresearch_grad$Department))
dept_statisticsresearch_grad <- unique(paste0(dept_statisticsresearch_grad_df$"Var1"," (n=", dept_statisticsresearch_grad_df$"Freq", ")"))
dept_statisticsresearch_grad[13] <- paste0("All Departments (n=", (sum(dept_statisticsresearch_grad_df$"Freq")), ")")
gathercols <- c("Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Core statistical concepts)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Hypothesis testing)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Linear regression and generalized linear models)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: classification)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: clustering)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Exploratory data analysis)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Smoothing, lasso, ridge regression, and regularization)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Mathematical modeling and simulations)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Running computational experiments)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Parameter estimation")
statisticsresearch_grad <- gather(statisticsresearch_grad, "Competency", "Importance", all_of(gathercols))
statisticsresearch_grad <- grad_df[, c("Please select your program of study.","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Core statistical concepts)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Hypothesis testing)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Linear regression and generalized linear models)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: classification)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: clustering)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Exploratory data analysis)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Smoothing, lasso, ridge regression, and regularization)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Mathematical modeling and simulations)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Running computational experiments)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Parameter estimation)")]
statisticsresearch_grad <- as.data.frame(statisticsresearch_grad)
n_statisticsresearch_grad <- nrow(statisticsresearch_grad)
statisticsresearch_grad <- statisticsresearch_grad %>% dplyr::rename("Department" = "Please select your program of study.")
statisticsresearch_grad[is.na(statisticsresearch_grad)] <- "Unchecked"
statisticsresearch_grad <- statisticsresearch_grad[!statisticsresearch_grad$"Department" == "Unchecked", ]
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Hypothesis testing)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Hypothesis testing)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Linear regression and generalized linear models)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Linear regression and generalized linear models)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: classification)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: classification)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: clustering)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: clustering)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Exploratory data analysis)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Exploratory data analysis)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Smoothing, lasso, ridge regression, and regularization)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Smoothing, lasso, ridge regression, and regularization)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Mathematical modeling and simulations)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Mathematical modeling and simulations)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Running computational experiments)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Running computational experiments)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Parameter estimation)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Parameter estimation)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Core statistical concepts)"[statisticsresearch_grad$"Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Core statistical concepts)"!= "Unchecked"] <- "Checked"
statisticsresearch_grad_raw <- statisticsresearch_grad
dept_statisticsresearch_grad_df <- as.data.frame(table(statisticsresearch_grad$Department))
dept_statisticsresearch_grad <- unique(paste0(dept_statisticsresearch_grad_df$"Var1"," (n=", dept_statisticsresearch_grad_df$"Freq", ")"))
dept_statisticsresearch_grad[13] <- paste0("All Departments (n=", (sum(dept_statisticsresearch_grad_df$"Freq")), ")")
gathercols <- c("Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Core statistical concepts)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Hypothesis testing)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Linear regression and generalized linear models)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: classification)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: clustering)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Exploratory data analysis)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Smoothing, lasso, ridge regression, and regularization)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Mathematical modeling and simulations)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Running computational experiments)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Parameter estimation")
statisticsresearch_grad <- gather(statisticsresearch_grad, "Competency", "Importance", all_of(gathercols))
gathercols <- c("Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Core statistical concepts)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Hypothesis testing)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Linear regression and generalized linear models)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: classification)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Machine learning: clustering)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Exploratory data analysis)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Smoothing, lasso, ridge regression, and regularization)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Mathematical modeling and simulations)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Running computational experiments)","Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice=Parameter estimation)")
statisticsresearch_grad <- gather(statisticsresearch_grad, "Competency", "Importance", all_of(gathercols))
statisticsresearch_grad <- data.frame(table(statisticsresearch_grad$Department, statisticsresearch_grad$Competency, statisticsresearch_grad$Importance))
statisticsresearch_grad <- statisticsresearch_grad %>% dplyr::rename("Department" = "Var1")
statisticsresearch_grad <- statisticsresearch_grad %>% dplyr::rename("Competency" = "Var2")
statisticsresearch_grad <- statisticsresearch_grad %>% dplyr::rename("Importance" = "Var3")
statisticsresearch_grad <- statisticsresearch_grad %>% mutate(across(.cols = everything(), ~str_replace( ., fixed("Which of the following statistics skills are important/applicable to your research now or will be in the future? Select all that apply. (choice="), "" )))
statisticsresearch_grad <- statisticsresearch_grad %>% convert(num(Freq))
## Skills Results : Statistics : Current skill level
statisticsskills_grad <- grad_df[, c("Please select your program of study.","Please select your CURRENT SKILL LEVEL for each of the following statistics skills: - Core statistical concepts)","Please select your CURRENT SKILL LEVEL for each of the following statistics skills: - Hypothesis testing)","Please select your CURRENT SKILL LEVEL for each of the following statistics skills: - Linear regression and generalized linear models)","Please select your CURRENT SKILL LEVEL for each of the following statistics skills: - Machine learning: classification)","Please select your CURRENT SKILL LEVEL for each of the following statistics skills: - Machine learning: clustering)","Please select your CURRENT SKILL LEVEL for each of the following statistics skills: - Exploratory data analysis)","Please select your CURRENT SKILL LEVEL for each of the following statistics skills: - Smoothing, lasso, ridge regression, and regularization)","Please select your CURRENT SKILL LEVEL for each of the following statistics skills: - Mathematical modeling and simulations)","Please select your CURRENT SKILL LEVEL for each of the following statistics skills: - Running computational experiments)","Please select your CURRENT SKILL LEVEL for each of the following statistics skills: - Parameter estimation)")]
statisticsskills_grad <- grad_df[, c("Please select your program of study.","Core statistical concepts)","Hypothesis testing)","Linear regression and generalized linear models)","Machine learning: classification)","Machine learning: clustering)","Exploratory data analysis)","Smoothing, lasso, ridge regression, and regularization)","Mathematical modeling and simulations)","Running computational experiments)","Parameter estimation)")]
statisticsskills_grad <- grad_df[, c("Please select your program of study.","Core statistical conceptsHypothesis testing","Linear regression and generalized linear models","Machine learning: classification","Machine learning: clustering","Exploratory data analysis","Smoothing, lasso, ridge regression, and regularization","Mathematical modeling and simulations","Running computational experiments","Parameter estimation)")]
statisticsskills_grad <- grad_df[, c("Please select your program of study.","Core statistical conceptsHypothesis testing","Linear regression and generalized linear models","Machine learning: classification","Machine learning: clustering","Exploratory data analysis","Smoothing and regularization","Mathematical modeling and simulations","Running computational experiments","Parameter estimation")]
## Skills Results : Statistics : Current skill level
statisticsskills_grad <- grad_df[, c("Please select your program of study.","Core statistical concepts","Hypothesis testing","Linear regression and generalized linear models","Machine learning: classification","Machine learning: clustering","Exploratory data analysis","Smoothing and regularization","Mathematical modeling and simulations","Running computational experiments","Parameter estimation")]
statisticsskills_grad_raw <- statisticsskills_grad
statisticsskills_grad <- as.data.frame(statisticsskills_grad)
n_statisticsskills_grad <- nrow(statisticsskills_grad)
statisticsskills_grad <- statisticsskills_grad %>% dplyr::rename("Department" = "Please select your program of study.")
dept_statisticsskills_grad_df <- as.data.frame(table(statisticsskills_grad$Department))
dept_statisticsskills_grad <- unique(paste0(dept_statisticsskills_grad_df$"Var1)"," (n=", dept_statisticsskills_grad_df$"Freq", ")"))
dept_statisticsskills_grad[13] <- paste0("All Departments (n=", (sum(dept_statisticsskills_grad_df$"Freq")), ")")
gathercols <- c("Core statistical concepts","Hypothesis testing","Linear regression and generalized linear models","Machine learning: classification","Machine learning: clustering","Exploratory data analysis","Smoothing and regularization","Mathematical modeling and simulations","Running computational experiments","Parameter estimation")
statisticsskills_grad <- gather(statisticsskills_grad, "Competency", "Current Skill Level", all_of(gathercols))
statisticsskills_grad <- data.frame(table(statisticsskills_grad$Department, statisticsskills_grad$Competency, statisticsskills_grad$"Current Skill Level"))
statisticsskills_grad <- statisticsskills_grad %>% dplyr::rename("Department" = "Var1")
statisticsskills_grad <- statisticsskills_grad %>% dplyr::rename("Competency" = "Var2")
statisticsskills_grad <- statisticsskills_grad %>% dplyr::rename("CurrentSkillLevel" = "Var3")
## Skills Results : Statistics : Current skill level
statisticsskills_grad <- grad_df[, c("Please select your program of study.","Core statistical concepts","Hypothesis testing","Linear regression and generalized linear models","Machine learning: classification","Machine learning: clustering","Exploratory data analysis","Smoothing and regularization","Mathematical modeling and simulations","Running computational experiments","Parameter estimation")]
statisticsskills_grad_raw <- statisticsskills_grad
statisticsskills_grad <- as.data.frame(statisticsskills_grad)
n_statisticsskills_grad <- nrow(statisticsskills_grad)
statisticsskills_grad <- statisticsskills_grad %>% dplyr::rename("Department" = "Please select your program of study.")
dept_statisticsskills_grad_df <- as.data.frame(table(statisticsskills_grad$Department))
dept_statisticsskills_grad <- unique(paste0(dept_statisticsskills_grad_df$"Var1)"," (n=", dept_statisticsskills_grad_df$"Freq", ")"))
dept_statisticsskills_grad[13] <- paste0("All Departments (n=", (sum(dept_statisticsskills_grad_df$"Freq")), ")")
gathercols <- c("Core statistical concepts","Hypothesis testing","Linear regression and generalized linear models","Machine learning: classification","Machine learning: clustering","Exploratory data analysis","Smoothing and regularization","Mathematical modeling and simulations","Running computational experiments","Parameter estimation")
statisticsskills_grad <- gather(statisticsskills_grad, "Competency", "Current Skill Level", all_of(gathercols))
statisticsskills_grad <- data.frame(table(statisticsskills_grad$Department, statisticsskills_grad$Competency, statisticsskills_grad$"Current Skill Level"))
statisticsskills_grad <- statisticsskills_grad %>% dplyr::rename("Department" = "Var1")
statisticsskills_grad <- statisticsskills_grad %>% dplyr::rename("Competency" = "Var2")
statisticsskills_grad <- statisticsskills_grad %>% dplyr::rename("CurrentSkillLevel" = "Var3")
runApp()
runApp()
runApp()
runApp()
runApp()
View(skills)
runApp()
runApp()
library(shiny)
library(shinydashboard)
library(shinydashboardPlus)
library(shinyjs)
library(plyr)
library(tidyverse)
library(ggplot2)
library(dplyr)
library(fresh)
library(DT)
library(readr)
library(scales)
library(billboarder)
library(tidyr)
library(shinyWidgets)
library(dslabs)
library(plotly)
library(stringr)
library(hablar)
library(showtext)
library(glue)
library(stringr)
library(httr)
library(tidyverse)
tableCodebook <- read_csv(file = codebookPath)
codebookPath = "Data/DataTableCodebook.csv"
tableCodebook <- read_csv(file = codebookPath)
setwd("/Users/sam/dev/spaghetti_dev/edw_acs")
tableCodebook <- read_csv(file = codebookPath)
tableList = unique(tableCodebook$"Table ID")
years <- formatC(2009:2021, width = 4, flag = "0")
# create a list of urls
urls <-data.frame("")
names(urls)<-c("url")
states <-data.frame("")
stateNames <- c("AL","AK","AZ","AR","CA","CO","CT","DE","DC","FL","GA","HA","ID","IL","IN","IO","KS","KY","LO","ME","MD","MA","MI","MN","MS","MO","MT","NE","NV","NH","NJ","NM","NY","NC","ND","OH","OK","OR","PN","RI","SC","SD","TN","TX","UT","VT","VA","WA","WV","WI","WY")
stateCodes <- formatC(1:51, width = 2, flag = "0")
states <- data.frame(stateNames, stateCodes)
names(states)<-c("state", "stateCode")
for (year in years) {
for (table in tableList) {
zctabaseUrl = paste(sep="", "https://api.census.gov/data/", year, "/acs/acs5?get=NAME,group(", table, ")&for=zip%20code%20tabulation%20area:*&key=", apiKey)
statebaseUrl = paste(sep="", "https://api.census.gov/data/", year, "/acs/acs5?get=NAME,group(", table, ")&for=state:*&key=", apiKey)
countybaseUrl = paste(sep="", "https://api.census.gov/data/", year, "/acs/acs5?get=NAME,group(", table, ")&for=county:*&key=", apiKey)
urls <- urls %>% add_row(url = zctabaseUrl)
urls <- urls %>% add_row(url = statebaseUrl)
urls <- urls %>% add_row(url = countybaseUrl)
for(i in 1:nrow(states)) {
row <- states[i,]
blockgroupbaseUrl = paste(sep="", "https://api.census.gov/data/", year, "/acs/acs5?get=NAME,group(", table, ")&for=block%20group:*&in=state:",row$stateCode, "%20county:*&key=", apiKey)
urls <- urls %>% add_row(url = blockgroupbaseUrl)
}}}
apiKey="12345"
for (year in years) {
for (table in tableList) {
zctabaseUrl = paste(sep="", "https://api.census.gov/data/", year, "/acs/acs5?get=NAME,group(", table, ")&for=zip%20code%20tabulation%20area:*&key=", apiKey)
statebaseUrl = paste(sep="", "https://api.census.gov/data/", year, "/acs/acs5?get=NAME,group(", table, ")&for=state:*&key=", apiKey)
countybaseUrl = paste(sep="", "https://api.census.gov/data/", year, "/acs/acs5?get=NAME,group(", table, ")&for=county:*&key=", apiKey)
urls <- urls %>% add_row(url = zctabaseUrl)
urls <- urls %>% add_row(url = statebaseUrl)
urls <- urls %>% add_row(url = countybaseUrl)
for(i in 1:nrow(states)) {
row <- states[i,]
blockgroupbaseUrl = paste(sep="", "https://api.census.gov/data/", year, "/acs/acs5?get=NAME,group(", table, ")&for=block%20group:*&in=state:",row$stateCode, "%20county:*&key=", apiKey)
urls <- urls %>% add_row(url = blockgroupbaseUrl)
}}}
View(states)
View(urls)
setwd("/Users/sam/dev/spaghetti_dev/NHANES/Code/R")
excluded <- read_csv("excludedtables.txt")
read.table(excludedtables.txt, sep = '\t')
read.table("excludedtables.txt"", sep = '\t')
read.table("excludedtables.txt"", sep = '\t')
read.table("excludedtables.txt", sep = '\t')
read.table("excludedtables.txt", sep = '\t')
read.table("excludedtables.txt", sep = '\t')
excludedTables <- read.table("Code/R/excludedtables.txt", sep = '\t')
getwd()
excludedTables <- read.table("excludedtables.txt", sep = '\t')
for (exclusion in excludedTables){
print(exclusion)
fileListTable <- fileListTable[!grepl(exclusion, fileListTable$'Data File Name'),]       # large files take a long time to download, not likely used in most cases
}
# Convert the HTML table to a data frame so we can iterate on the rows
htmlObj = xml2::read_html(paste(collapse="\n", htmlFileList[htmlTableStartLine : htmlTableEndLine]))
# Try using the comprehensive listing
comprehensiveHtmlDataList = "https://wwwn.cdc.gov/nchs/nhanes/search/datapage.aspx"
htmlFileList = readLines(comprehensiveHtmlDataList)
htmlTableStartLine = grep(x = htmlFileList, pattern = "<table")
htmlTableEndLine = grep(x = htmlFileList, pattern = "</table")
if (length(htmlTableStartLine) != 1 || length(htmlTableEndLine) != 1 ) {
stop(
paste(
"The original HTML file listing at",
comprehensiveHtmlDataList,
"contained only one table.  You will need to do some investigation and debugging."
)
)
}
# Convert the HTML table to a data frame so we can iterate on the rows
htmlObj = xml2::read_html(paste(collapse="\n", htmlFileList[htmlTableStartLine : htmlTableEndLine]))
fileListTable = dplyr::`%>%`(htmlObj, rvest::html_table())[[1]]
# Create a new column 'Data File Name' populated with each file name from the 'Doc File' column without ' Doc'. eg. 'ACQ_D Doc' -> 'ACQ_D'
fileListTable$'Data File Name' <- gsub(" Doc","",as.character(fileListTable$'Doc File'))
# Some years in the year column do not match up with the year value in the url. eg. 'SSHCV' year
# column shows '2007-2012' but the url is https://wwwn.cdc.gov/Nchs/Nhanes/2007-2008/SSHCV_E.XPT.
# lines 75-78 correct where this occurs in the table
fileListTable$Years[fileListTable$Years == "1988-2020"] <- '1999-2000'
fileListTable$Years[fileListTable$Years == "2007-2012"] <- '2007-2008'
fileListTable$Years[fileListTable$Years == "1999-2004"] <- '1999-2000'
fileListTable$Years[fileListTable$Years == "1999-2020"] <- '1999-2000'
# Replace the hyperlink in the Doc File column with the full url
fileListTable$'Doc File' <- glue("https://wwwn.cdc.gov/Nchs/Nhanes/{fileListTable$Years}/{fileListTable$'Doc File'}.htm")
fileListTable$'Doc File'<-gsub(" Doc","",as.character(fileListTable$'Doc File'))
# Replace the hyperlink in the Data File column with the full url
fileListTable$'Data File' <- glue("https://wwwn.cdc.gov/Nchs/Nhanes/{fileListTable$Years}/{fileListTable$'Data File'}.XPT")
fileListTable$'Data File'<- gsub('([A-z]+) .*', '\\1', as.character(fileListTable$'Data File'))
fileListTable$'Data File' <- paste0(fileListTable$'Data File', ".XPT")
fileListTable$'Data File'<-gsub(" Data","",as.character(fileListTable$'Data File'))
excludedTables <- read.table("Code/R/excludedtables.txt", sep = '\t')
excludedTables <- read.table("excludedtables.txt", sep = '\t')
for (exclusion in excludedTables){
print(exclusion)
fileListTable <- fileListTable[!grepl(exclusion, fileListTable$'Data File Name'),]       # large files take a long time to download, not likely used in most cases
}
excludedTables
excludedTables[0]
excludedTables[1]
for(i in 1:nrow(excludedTables)){print(excludedTables[i])}
for(i in 1:nrow(excludedTables)-1){print(excludedTables[i])}
for(i in 1:nrow(excludedTables)){print(i)}
excludedTables[1]
excludedTables <- read_csv("excludedtables.txt", sep="\t")
excludedTables <- read_csv("excludedtables.txt", sep='\t')
excludedTables <- read_csv("excludedtables.txt")
excludedTables
for(i in 1:nrow(excludedTables)){print(excludedTables[i])}
nrow(excludedTables)
for(i in excludedTables){print(i)}
for(i in seq_along(excludedTables)){print(i)}
data.frame(excludedTables)
data.frame(excludedTables, header=FALSE)
for(i in 1:nrow(excludedTables)) {print(i)}
for(i in 1:nrow(excludedTables)) {print(excludedTables[i,])}
for(i in 1:nrow(excludedTables)) {print(excludedTables[1,i])}
for(i in 1:nrow(excludedTables)) {print(excludedTables[1][i])}
for(i in 1:nrow(excludedTables)) {print(excludedTables[,i])}
for(i in 1:nrow(excludedTables)) {print(excludedTables[i,])}
excludedTables <- read_csv("excludedtables.txt")
excludedTables <- read_csv("excludedtables.txt")
for(i in 1:nrow(excludedTables)) {print(excludedTables[i,])}
for(i in 1:nrow(excludedTables)) {val <- excludedTables[i,]}
val
i
excludedTables[i]
excludedTables$i
excludedTables$ExcludedTables[i]
exclusions <- commandArgs(read_csv("Code/R/excludedtables.txt"))
excludedTables <- read_csv("excludedtables.txt")
for(i in 1:nrow(excludedTables)){
fileListTable <- fileListTable[!grepl(excludedTables$ExcludedTables[i], fileListTable$'Data File'),]
}
comprehensiveHtmlDataList = "https://wwwn.cdc.gov/nchs/nhanes/search/datapage.aspx"
htmlFileList = readLines(comprehensiveHtmlDataList)
htmlTableStartLine = grep(x = htmlFileList, pattern = "<table")
htmlTableEndLine = grep(x = htmlFileList, pattern = "</table")
if (length(htmlTableStartLine) != 1 || length(htmlTableEndLine) != 1 ) {
stop(
paste(
"The original HTML file listing at",
comprehensiveHtmlDataList,
"contained only one table.  You will need to do some investigation and debugging."
)
)
}
# Convert the HTML table to a data frame so we can iterate on the rows
htmlObj = xml2::read_html(paste(collapse="\n", htmlFileList[htmlTableStartLine : htmlTableEndLine]))
fileListTable = dplyr::`%>%`(htmlObj, rvest::html_table())[[1]]
# Create a new column 'Data File Name' populated with each file name from the 'Doc File' column without ' Doc'. eg. 'ACQ_D Doc' -> 'ACQ_D'
fileListTable$'Data File Name' <- gsub(" Doc","",as.character(fileListTable$'Doc File'))
# Some years in the year column do not match up with the year value in the url. eg. 'SSHCV' year
# column shows '2007-2012' but the url is https://wwwn.cdc.gov/Nchs/Nhanes/2007-2008/SSHCV_E.XPT.
# lines 75-78 correct where this occurs in the table
fileListTable$Years[fileListTable$Years == "1988-2020"] <- '1999-2000'
fileListTable$Years[fileListTable$Years == "2007-2012"] <- '2007-2008'
fileListTable$Years[fileListTable$Years == "1999-2004"] <- '1999-2000'
fileListTable$Years[fileListTable$Years == "1999-2020"] <- '1999-2000'
# Replace the hyperlink in the Doc File column with the full url
fileListTable$'Doc File' <- glue("https://wwwn.cdc.gov/Nchs/Nhanes/{fileListTable$Years}/{fileListTable$'Doc File'}.htm")
fileListTable$'Doc File'<-gsub(" Doc","",as.character(fileListTable$'Doc File'))
# Replace the hyperlink in the Data File column with the full url
fileListTable$'Data File' <- glue("https://wwwn.cdc.gov/Nchs/Nhanes/{fileListTable$Years}/{fileListTable$'Data File'}.XPT")
fileListTable$'Data File'<- gsub('([A-z]+) .*', '\\1', as.character(fileListTable$'Data File'))
fileListTable$'Data File' <- paste0(fileListTable$'Data File', ".XPT")
fileListTable$'Data File'<-gsub(" Data","",as.character(fileListTable$'Data File'))
excludedTables <- read_csv("Code/R/excludedtables.txt")
excludedTables <- read_csv("excludedtables.txt")
for(i in 1:nrow(excludedTables)){
fileListTable <- fileListTable[!grepl(excludedTables$ExcludedTables[i], fileListTable$'Data File'),]
}
fileListTable <- fileListTable[!grepl(excludedTables$ExcludedTables[i], fileListTable$'Data File'),]
comprehensiveHtmlDataList = "https://wwwn.cdc.gov/nchs/nhanes/search/datapage.aspx"
htmlFileList = readLines(comprehensiveHtmlDataList)
htmlTableStartLine = grep(x = htmlFileList, pattern = "<table")
htmlTableEndLine = grep(x = htmlFileList, pattern = "</table")
if (length(htmlTableStartLine) != 1 || length(htmlTableEndLine) != 1 ) {
stop(
paste(
"The original HTML file listing at",
comprehensiveHtmlDataList,
"contained only one table.  You will need to do some investigation and debugging."
)
)
}
# Convert the HTML table to a data frame so we can iterate on the rows
htmlObj = xml2::read_html(paste(collapse="\n", htmlFileList[htmlTableStartLine : htmlTableEndLine]))
fileListTable = dplyr::`%>%`(htmlObj, rvest::html_table())[[1]]
# Create a new column 'Data File Name' populated with each file name from the 'Doc File' column without ' Doc'. eg. 'ACQ_D Doc' -> 'ACQ_D'
fileListTable$'Data File Name' <- gsub(" Doc","",as.character(fileListTable$'Doc File'))
# Some years in the year column do not match up with the year value in the url. eg. 'SSHCV' year
# column shows '2007-2012' but the url is https://wwwn.cdc.gov/Nchs/Nhanes/2007-2008/SSHCV_E.XPT.
# lines 75-78 correct where this occurs in the table
fileListTable$Years[fileListTable$Years == "1988-2020"] <- '1999-2000'
fileListTable$Years[fileListTable$Years == "2007-2012"] <- '2007-2008'
fileListTable$Years[fileListTable$Years == "1999-2004"] <- '1999-2000'
fileListTable$Years[fileListTable$Years == "1999-2020"] <- '1999-2000'
# Replace the hyperlink in the Doc File column with the full url
fileListTable$'Doc File' <- glue("https://wwwn.cdc.gov/Nchs/Nhanes/{fileListTable$Years}/{fileListTable$'Doc File'}.htm")
fileListTable$'Doc File'<-gsub(" Doc","",as.character(fileListTable$'Doc File'))
# Replace the hyperlink in the Data File column with the full url
fileListTable$'Data File' <- glue("https://wwwn.cdc.gov/Nchs/Nhanes/{fileListTable$Years}/{fileListTable$'Data File'}.XPT")
fileListTable$'Data File'<- gsub('([A-z]+) .*', '\\1', as.character(fileListTable$'Data File'))
fileListTable$'Data File' <- paste0(fileListTable$'Data File', ".XPT")
fileListTable$'Data File'<-gsub(" Data","",as.character(fileListTable$'Data File'))
excludedTables <- read_csv("Code/R/excludedtables.txt")
comprehensiveHtmlDataList = "https://wwwn.cdc.gov/nchs/nhanes/search/datapage.aspx"
htmlFileList = readLines(comprehensiveHtmlDataList)
htmlTableStartLine = grep(x = htmlFileList, pattern = "<table")
htmlTableEndLine = grep(x = htmlFileList, pattern = "</table")
if (length(htmlTableStartLine) != 1 || length(htmlTableEndLine) != 1 ) {
stop(
paste(
"The original HTML file listing at",
comprehensiveHtmlDataList,
"contained only one table.  You will need to do some investigation and debugging."
)
)
}
# Convert the HTML table to a data frame so we can iterate on the rows
htmlObj = xml2::read_html(paste(collapse="\n", htmlFileList[htmlTableStartLine : htmlTableEndLine]))
fileListTable = dplyr::`%>%`(htmlObj, rvest::html_table())[[1]]
# Create a new column 'Data File Name' populated with each file name from the 'Doc File' column without ' Doc'. eg. 'ACQ_D Doc' -> 'ACQ_D'
fileListTable$'Data File Name' <- gsub(" Doc","",as.character(fileListTable$'Doc File'))
# Some years in the year column do not match up with the year value in the url. eg. 'SSHCV' year
# column shows '2007-2012' but the url is https://wwwn.cdc.gov/Nchs/Nhanes/2007-2008/SSHCV_E.XPT.
# lines 75-78 correct where this occurs in the table
fileListTable$Years[fileListTable$Years == "1988-2020"] <- '1999-2000'
fileListTable$Years[fileListTable$Years == "2007-2012"] <- '2007-2008'
fileListTable$Years[fileListTable$Years == "1999-2004"] <- '1999-2000'
fileListTable$Years[fileListTable$Years == "1999-2020"] <- '1999-2000'
# Replace the hyperlink in the Doc File column with the full url
fileListTable$'Doc File' <- glue("https://wwwn.cdc.gov/Nchs/Nhanes/{fileListTable$Years}/{fileListTable$'Doc File'}.htm")
fileListTable$'Doc File'<-gsub(" Doc","",as.character(fileListTable$'Doc File'))
# Replace the hyperlink in the Data File column with the full url
fileListTable$'Data File' <- glue("https://wwwn.cdc.gov/Nchs/Nhanes/{fileListTable$Years}/{fileListTable$'Data File'}.XPT")
fileListTable$'Data File'<- gsub('([A-z]+) .*', '\\1', as.character(fileListTable$'Data File'))
fileListTable$'Data File' <- paste0(fileListTable$'Data File', ".XPT")
fileListTable$'Data File'<-gsub(" Data","",as.character(fileListTable$'Data File'))
excludedTables <- read_csv("excludedtables.txt")
for(i in 1:nrow(excludedTables)){
fileListTable <- fileListTable[grepl(excludedTables$ExcludedTables[i], fileListTable$'Data File'),]
}
View(fileListTable)
comprehensiveHtmlDataList = "https://wwwn.cdc.gov/nchs/nhanes/search/datapage.aspx"
htmlFileList = readLines(comprehensiveHtmlDataList)
htmlTableStartLine = grep(x = htmlFileList, pattern = "<table")
htmlTableEndLine = grep(x = htmlFileList, pattern = "</table")
if (length(htmlTableStartLine) != 1 || length(htmlTableEndLine) != 1 ) {
stop(
paste(
"The original HTML file listing at",
comprehensiveHtmlDataList,
"contained only one table.  You will need to do some investigation and debugging."
)
)
}
# Convert the HTML table to a data frame so we can iterate on the rows
htmlObj = xml2::read_html(paste(collapse="\n", htmlFileList[htmlTableStartLine : htmlTableEndLine]))
fileListTable = dplyr::`%>%`(htmlObj, rvest::html_table())[[1]]
# Create a new column 'Data File Name' populated with each file name from the 'Doc File' column without ' Doc'. eg. 'ACQ_D Doc' -> 'ACQ_D'
fileListTable$'Data File Name' <- gsub(" Doc","",as.character(fileListTable$'Doc File'))
# Some years in the year column do not match up with the year value in the url. eg. 'SSHCV' year
# column shows '2007-2012' but the url is https://wwwn.cdc.gov/Nchs/Nhanes/2007-2008/SSHCV_E.XPT.
# lines 75-78 correct where this occurs in the table
fileListTable$Years[fileListTable$Years == "1988-2020"] <- '1999-2000'
fileListTable$Years[fileListTable$Years == "2007-2012"] <- '2007-2008'
fileListTable$Years[fileListTable$Years == "1999-2004"] <- '1999-2000'
fileListTable$Years[fileListTable$Years == "1999-2020"] <- '1999-2000'
# Replace the hyperlink in the Doc File column with the full url
fileListTable$'Doc File' <- glue("https://wwwn.cdc.gov/Nchs/Nhanes/{fileListTable$Years}/{fileListTable$'Doc File'}.htm")
fileListTable$'Doc File'<-gsub(" Doc","",as.character(fileListTable$'Doc File'))
# Replace the hyperlink in the Data File column with the full url
fileListTable$'Data File' <- glue("https://wwwn.cdc.gov/Nchs/Nhanes/{fileListTable$Years}/{fileListTable$'Data File'}.XPT")
fileListTable$'Data File'<- gsub('([A-z]+) .*', '\\1', as.character(fileListTable$'Data File'))
fileListTable$'Data File' <- paste0(fileListTable$'Data File', ".XPT")
fileListTable$'Data File'<-gsub(" Data","",as.character(fileListTable$'Data File'))
excludedTables <- read_csv("excludedtables.txt")
for(i in 1:nrow(excludedTables)){
test <- fileListTable[grepl(excludedTables$ExcludedTables[i], fileListTable$'Data File'),]
}
View(test)
test <- fileListTable[grepl(paste(excludedTables$ExcludedTables, collapse = "|"), fileListTable$'Data File'),]
View(test)
comprehensiveHtmlDataList = "https://wwwn.cdc.gov/nchs/nhanes/search/datapage.aspx"
htmlFileList = readLines(comprehensiveHtmlDataList)
htmlTableStartLine = grep(x = htmlFileList, pattern = "<table")
htmlTableEndLine = grep(x = htmlFileList, pattern = "</table")
if (length(htmlTableStartLine) != 1 || length(htmlTableEndLine) != 1 ) {
stop(
paste(
"The original HTML file listing at",
comprehensiveHtmlDataList,
"contained only one table.  You will need to do some investigation and debugging."
)
)
}
# Convert the HTML table to a data frame so we can iterate on the rows
htmlObj = xml2::read_html(paste(collapse="\n", htmlFileList[htmlTableStartLine : htmlTableEndLine]))
fileListTable = dplyr::`%>%`(htmlObj, rvest::html_table())[[1]]
# Create a new column 'Data File Name' populated with each file name from the 'Doc File' column without ' Doc'. eg. 'ACQ_D Doc' -> 'ACQ_D'
fileListTable$'Data File Name' <- gsub(" Doc","",as.character(fileListTable$'Doc File'))
# Some years in the year column do not match up with the year value in the url. eg. 'SSHCV' year
# column shows '2007-2012' but the url is https://wwwn.cdc.gov/Nchs/Nhanes/2007-2008/SSHCV_E.XPT.
# lines 75-78 correct where this occurs in the table
fileListTable$Years[fileListTable$Years == "1988-2020"] <- '1999-2000'
fileListTable$Years[fileListTable$Years == "2007-2012"] <- '2007-2008'
fileListTable$Years[fileListTable$Years == "1999-2004"] <- '1999-2000'
fileListTable$Years[fileListTable$Years == "1999-2020"] <- '1999-2000'
# Replace the hyperlink in the Doc File column with the full url
fileListTable$'Doc File' <- glue("https://wwwn.cdc.gov/Nchs/Nhanes/{fileListTable$Years}/{fileListTable$'Doc File'}.htm")
fileListTable$'Doc File'<-gsub(" Doc","",as.character(fileListTable$'Doc File'))
# Replace the hyperlink in the Data File column with the full url
fileListTable$'Data File' <- glue("https://wwwn.cdc.gov/Nchs/Nhanes/{fileListTable$Years}/{fileListTable$'Data File'}.XPT")
fileListTable$'Data File'<- gsub('([A-z]+) .*', '\\1', as.character(fileListTable$'Data File'))
fileListTable$'Data File' <- paste0(fileListTable$'Data File', ".XPT")
fileListTable$'Data File'<-gsub(" Data","",as.character(fileListTable$'Data File'))
excludedTables <- read_csv("excludedtables.txt")
fileListTable <- fileListTable[!grepl(paste(excludedTables$ExcludedTables, collapse = "|"), fileListTable$'Data File'),]
comprehensiveHtmlDataList = "https://wwwn.cdc.gov/nchs/nhanes/search/datapage.aspx"
htmlFileList = readLines(comprehensiveHtmlDataList)
htmlTableStartLine = grep(x = htmlFileList, pattern = "<table")
htmlTableEndLine = grep(x = htmlFileList, pattern = "</table")
if (length(htmlTableStartLine) != 1 || length(htmlTableEndLine) != 1 ) {
stop(
paste(
"The original HTML file listing at",
comprehensiveHtmlDataList,
"contained only one table.  You will need to do some investigation and debugging."
)
)
}
# Convert the HTML table to a data frame so we can iterate on the rows
htmlObj = xml2::read_html(paste(collapse="\n", htmlFileList[htmlTableStartLine : htmlTableEndLine]))
fileListTable = dplyr::`%>%`(htmlObj, rvest::html_table())[[1]]
# Create a new column 'Data File Name' populated with each file name from the 'Doc File' column without ' Doc'. eg. 'ACQ_D Doc' -> 'ACQ_D'
fileListTable$'Data File Name' <- gsub(" Doc","",as.character(fileListTable$'Doc File'))
# Some years in the year column do not match up with the year value in the url. eg. 'SSHCV' year
# column shows '2007-2012' but the url is https://wwwn.cdc.gov/Nchs/Nhanes/2007-2008/SSHCV_E.XPT.
# lines 75-78 correct where this occurs in the table
fileListTable$Years[fileListTable$Years == "1988-2020"] <- '1999-2000'
fileListTable$Years[fileListTable$Years == "2007-2012"] <- '2007-2008'
fileListTable$Years[fileListTable$Years == "1999-2004"] <- '1999-2000'
fileListTable$Years[fileListTable$Years == "1999-2020"] <- '1999-2000'
# Replace the hyperlink in the Doc File column with the full url
fileListTable$'Doc File' <- glue("https://wwwn.cdc.gov/Nchs/Nhanes/{fileListTable$Years}/{fileListTable$'Doc File'}.htm")
fileListTable$'Doc File'<-gsub(" Doc","",as.character(fileListTable$'Doc File'))
# Replace the hyperlink in the Data File column with the full url
fileListTable$'Data File' <- glue("https://wwwn.cdc.gov/Nchs/Nhanes/{fileListTable$Years}/{fileListTable$'Data File'}.XPT")
fileListTable$'Data File'<- gsub('([A-z]+) .*', '\\1', as.character(fileListTable$'Data File'))
fileListTable$'Data File' <- paste0(fileListTable$'Data File', ".XPT")
fileListTable$'Data File'<-gsub(" Data","",as.character(fileListTable$'Data File'))
excludedTables <- read_csv("excludedtables.txt")
fileListTable <- fileListTable[grepl(paste(excludedTables$ExcludedTables, collapse = "|"), fileListTable$'Data File'),]
View(fileListTable)
runApp('~/dev/spaghetti_dev/edu-data-repo')
runApp('~/dev/spaghetti_dev/edu-data-repo')
